(function(i){"use strict";i(document).ready(function(){var t,e=i(".yz-giphy-submit-search"),a=e.text(),n='<div class="yz-giphy-grid-sizer"></div>',s=i(".yz-load-more-giphys"),o=s.text(),d=(i(".yz-selected-giphy-item"),{itemSelector:".yz-giphy-item",columnWidth:".yz-giphy-grid-sizer",percentPosition:!0,gutter:10}),y=!1;i(document).on("click",".yz-delete-giphy-item",function(){var e=i(this).closest("form");e.find(".yz-selected-giphy-item").fadeOut(400,function(){i(this).find("img").remove(),i(this).find("input").val(""),e.find(".yz-wall-giphy-form .yz-wall-cf-item").fadeIn(200,function(){t=e.find(".yz-giphy-items-content").masonry(d)})})}),i(document).on("click",".yz-giphy-item img",function(t){if(!0!==y){y=!0;var e=i(this).attr("data-original"),a=i(this).closest("form"),n=a.find(".yz-selected-giphy-item");a.find(".yz-wall-giphy-form .yz-wall-cf-item").fadeOut(400,function(){a.find(".yz-giphy-loading-preview").fadeIn(),n.find("input").val(e);var t=i("<img>").attr({src:e});n.prepend(t),i(t).on("load",function(i){a.find(".yz-giphy-loading-preview").fadeOut(100,function(){n.fadeIn().css("display","inline-block"),y=!1})})})}}),i(document).on("click",".yz-giphy-submit-search","click",function(){var e=i(this).closest("form"),a=e.find(".yz-giphy-submit-search"),s=i(this).prev(".yz-giphy-search-input").val(),o=e.find(".yz-load-more-giphys");o.fadeOut(1),o.attr("data-query",s),o.attr("data-page",2),e.find(".yz-giphy-items-content").html(n),t=e.find(".yz-giphy-items-content").masonry(d),""!=s&&(a.addClass("loading"),a.html('<i class="fas fa-spin fa-spinner"></i>'),i.yz_LoadGiphyItems(e,{q:s}))}),i(document).on("keypress",".yz-giphy-search-input",function(t){13==t.keyCode&&(t.preventDefault(),i(this).closest("form").find(".yz-giphy-submit-search").click())}),i(document).on("click",".yz-load-more-giphys",function(t){var e=i(this).closest("form"),a=e.find(".yz-load-more-giphys");a.addClass("loading"),a.html('<i class="fas fa-spinner fa-spin"></i>');var n=parseInt(i(this).attr("data-page")),s={q:i(this).attr("data-query"),offset:n*Yz_Wall.giphy_limit-2};i.yz_LoadGiphyItems(e,s);i(this).attr("data-page",n+1)}),i.fn.yz_giphy_masonryImagesReveal=function(t,e,n){var s=t.find(".yz-giphy-submit-search"),d=t.find(".yz-load-more-giphys"),y=this.data("masonry"),r=y.options.itemSelector;return e.hide(),this.append(e),e.imagesLoaded().progress(function(e,l){var h=i(l.img).parents(r);h.show(1,function(){y.appended(i(this)),1==n&&d.fadeIn(),s.hasClass("loading")&&(s.removeClass("loading"),s.html(a)),d.hasClass("loading")&&(d.removeClass("loading"),d.html(o))}),t.find(".yz-giphy-items-content").animate({scrollTop:t.find(".yz-giphy-items-content").prop("scrollHeight")},1e3)}),this},i.yz_LoadGiphyItems=function(e,a){var s,o,d=i.extend({api_key:"aFFKTuSMjd6j0wwjpFCPXZipQbcnw3vB",limit:Yz_Wall.giphy_limit,fmt:"json",rating:"g"},a),y="";i.ajax({url:"https://api.giphy.com/v1/gifs/search?"+i.param(d),method:"GET",success:function(a){if(0!==a.data.length){for(void 0===d.offset&&e.find(".yz-giphy-items-content").html(n),s=0;s<d.limit;s++){var r=a.data[s].images;y+='<div class="yz-giphy-item"><img src="'+r.fixed_height.url+'" data-original="'+r.original.url+'"></div>'}o=a.pagination.total_count>d.limit,t.yz_giphy_masonryImagesReveal(e,i(y),o)}}})}})})(jQuery);