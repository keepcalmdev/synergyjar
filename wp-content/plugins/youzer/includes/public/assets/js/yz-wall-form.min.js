(function(e){"use strict";e(document).ready(function(){var t=!1;e(document).on("input click",".yz-wall-textarea, .ac-input",function(){e(this).next(".yz-load-emojis").attr("data-cursor",e(this).prop("selectionStart"))}),e(document).on("focus",".yz-wall-textarea",function(){0==t&&(e(this).closest("form").find(".yz-lp-prepost").get(0)&&(e("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/yz-url-preview.min.css"}).appendTo("head"),e("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/yz-url-preview.min.js"}).appendTo("head")),t=!0)}),e(document).on("click",".yz-load-emojis",function(){e(this).closest("form");e(this).find("i").attr("class","fas fa-spin fa-spinner"),e(this).addClass("loading"),e("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/emojionearea.min.css"}).appendTo("head"),e("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/emojionearea.min.js"}).appendTo("head")}),e(".yz-wall-post").on("click",function(){var t,a=0,i=e(this),s=e(this).text(),n=i.closest("form#yz-wall-form"),l={};e.each(n.serializeArray(),function(t,a){"_"!==a.name.substr(0,1)&&"whats-new"!==a.name.substr(0,9)&&(l[a.name]?e.isArray(l[a.name])?l[a.name].push(a.value):l[a.name]=new Array(l[a.name],a.value):l[a.name]=a.value)}),n.find("*").each(function(){(e.nodeName(this,"textarea")||e.nodeName(this,"input"))&&e(this).prop("disabled",!0)}),n.find(".yz-wall-textarea").get(0).emojioneArea&&n.find(".yz-wall-textarea").data("emojioneArea").disable(),i.addClass("loading"),i.prop("disabled",!0),n.addClass("submitted"),i.css("min-width",i.css("width")),i.html('<i class="fas fa-spinner fa-spin"></i>');var d="",o=e("#yz-whats-new-post-in").val(),c=e("#whats-new").val(),r=e("#buddypress ul.activity-list li").first(),f=r,y=null;return r.length&&(f.hasClass("load-newest")&&(f=r.next()),y=f.prop("class").match(/date-recorded-([0-9]+)/)),y&&(a=y[1]),o>0&&(d=e("#yz-whats-new-post-object").val()),t=e.extend({action:"yz_post_update",cookie:bp_get_cookies(),_yz_wpnonce_post_update:e("#_yz_wpnonce_post_update").val(),content:c,object:d,item_id:o,since:a,_bp_as_nonce:e("#_bp_as_nonce").val()||""},l),e.post(ajaxurl,t,function(t){if(n.find("*").each(function(){(e.nodeName(this,"textarea")||e.nodeName(this,"input"))&&e(this).prop("disabled",!1)}),n.find(".yz-wall-textarea").get(0).emojioneArea&&n.find(".yz-wall-textarea").data("emojioneArea").enable(),e.yz_isJSON(t)){var d=e.parseJSON(t);e.yz_DialogMsg("error",d.error)}else{if(e("#whats-new-post-in-box .nice-select").css("border","1px solid #eee"),i.html('<i class="fas fa-check"></i>').hide().fadeIn("slow"),n.find(".yz-delete-attachment").trigger("click"),0===e("ul.activity-list").length&&(e("div.error").slideUp(100).remove(),e("#message").slideUp(100).remove(),e("div.activity").append('<ul id="activity-stream" class="activity-list item-list">')),r.hasClass("load-newest")&&r.remove(),e("#activity-stream").prepend(t),a||e("#activity-stream li:first").addClass("new-update just-posted"),console.log(o),e("body,html").animate({},1e3),0!==e("#latest-update").length){var c=e("#activity-stream li.new-update .activity-content .activity-inner p").html(),f=e("#activity-stream li.new-update .activity-content .activity-header p a.view").attr("href"),y=e("#activity-stream li.new-update .activity-content .activity-inner p").text(),u="";""!==y&&(u=c+" "),u+='<a href="'+f+'" rel="nofollow">'+BP_DTheme.view+"</a>",e("#latest-update").slideUp(300,function(){e("#latest-update").html(u),e("#latest-update").slideDown(300)})}e("li.new-update").hide().slideDown(300),e("li.new-update").removeClass("new-update"),e("#whats-new").val(""),"activity_slideshow"==l.post_type&&e.youzer_sliders_init(),n.get(0).reset(),n.find(".yz-wall-textarea").get(0).emojioneArea&&n.find(".yz-wall-textarea").get(0).emojioneArea.setText(""),n.find(".yz-tagged-user .yz-tagusers-delete-user, .yz-list-delete-item, .yz-list-close-icon").trigger("click"),n.find("div.yz-activity-privacy").find(".list div").first().trigger("click"),n.find("#yz-whats-new-post-in").next(".nice-select").find(".list div").first().trigger("click"),n.find('.yz-wall-options input:radio[name="post_type"]').first().trigger("change"),n.find(".yz-lp-prepost .lp-button-cancel").trigger("click"),"activity_giphy"==l.post_type&&(n.find(".yz-delete-giphy-item").trigger("click"),n.find(".yz-giphy-submit-search").val("").trigger("click")),newest_activities="",activity_last_recorded=0}setTimeout(function(){i.html(s).fadeIn("slow")},1e3),n.find(".yz-wall-post,.yz-update-post").prop("disabled",!1).removeClass("loading")}),!1}),e(document).on("change",'input:radio[name="post_type"]',function(){var t=e(this).closest("form"),a=e(this).val(),i=e(this).data("uploader"),s=e('input:radio[name="post_type"]').length;s>1?0==t.find('.yz-wall-custom-form[data-post-type!="'+a+'"]').length?t.find('.yz-wall-custom-form[data-post-type="'+a+'"]').fadeIn():t.find('.yz-wall-custom-form[data-post-type!="'+a+'"]').fadeOut(1,function(){t.find('.yz-wall-custom-form[data-post-type="'+a+'"]').fadeIn()}):t.find('.yz-wall-custom-form[data-post-type="'+a+'"]').fadeIn(),"on"==i?t.find(".yz-wall-actions .yz-wall-upload-btn").fadeIn():t.find(".yz-wall-actions .yz-wall-upload-btn").fadeOut(),"activity_video"==a?t.find(".yz-upload-attachments").attr("accept","video/*"):"activity_audio"==a?t.find(".yz-upload-attachments").attr("accept","audio/*"):"activity_file"==a?t.find(".yz-upload-attachments").removeAttr("accept"):t.find(".yz-upload-attachments").attr("accept","image/*"),t.find('.yz-wall-custom-form[data-post-type="'+a+'"]').find('input[type="text"]')[0]&&t.find('.yz-wall-custom-form[data-post-type="'+a+'"]').find('input[type="text"]')[0].focus(),t.find(".yz-attachment-item").remove()}),e('input:radio[name="post_type"]').first().trigger("change"),e(document).on("click",".yz-wall-upload-btn",function(t){yz_load_attachments||(e("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/yz-attachments.min.js"}).appendTo("head"),e("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/yz-attachments.min.css"}).appendTo("head"),yz_load_attachments=!0);var a=e(this).closest("form");return!a.find(".yz-file-progress")[0]&&((!a.hasClass("ac-form")||(a.find(".yz-wall-upload-btn").fadeOut(),!a.find(".yz-attachment-item")[0]))&&(a.find(".yz-upload-attachments").click(),void t.preventDefault()))}),e(document).on("click",".yz-tag-users-tool",function(){var t=e(this).closest("form");if(t.find(".yz-feeling-form").fadeOut(),e(this).hasClass("loaded"))return t.find(".yz-tagusers-form").fadeToggle(),void t.find(".yz-tagusers-search-input").focus();var a=e(this),i=a.find("i"),s=i.attr("class");i.attr("class","fas fa-spinner fa-spin"),e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"yz_tag_users_get_user_friends"},success:function(n){a.addClass("loaded");var l=e("<div></div>").append(n.data);if("youzer-edit-activity-wrapper"==t.parent().attr("id")){var d=[];t.find('input[name="tagged_users[]"]').each(function(){l.find('.yz-list-item[data-user-id="100"] ').fadeOut(),d.push(e(this).val())}),l.find(".yz-list-item").each(function(t,a){-1!==jQuery.inArray(e(this).attr("data-user-id"),d)&&e(this).find(".yz-wall-tag-user").hide()})}t.find(".yz-tagusers-form").fadeIn(200,function(){i.attr("class",s),t.find(".yz-tagusers-search-input").focus(),t.find(".yz-wall-tagusers-list").html(l)})}})}),e(document).on("keyup",".yz-list-search-input",function(){var t=e(this).closest(".yz-wall-list"),a=this.value.toLowerCase().trim();t.find(".yz-wall-list-items .yz-list-item").show().filter(function(){return-1==e(this).find(".yz-item-title, .yz-item-description").text().toLowerCase().trim().indexOf(a)}).hide()}),e(document).on("click",".yz-user-mood-tool",function(){var t=e(this).closest("form");if(t.find(".yz-tagusers-form").fadeOut(),e(this).hasClass("loaded"))return t.find(".yz-feeling-form").fadeToggle(),void t.find(".yz-feeling-search-input").focus();t.find(".yz-feeling-form").attr("data-placeholder",t.find(".yz-feeling-search-input").attr("placeholder"));var a=e(this),i=a.find("i"),s=i.attr("class");i.attr("class","fas fa-spinner fa-spin"),e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"yz_feeling_activity_get_categories"},success:function(e){a.addClass("loaded"),t.find(".yz-feeling-form").fadeIn(200,function(){i.attr("class",s),t.find(".yz-feeling-search-input").focus(),t.find(".yz-wall-feeling-list").html(e.data)})}})}),e(document).on("click",".yz-feeling-item",function(t){t.preventDefault();var a=e(this),i=a.closest(".yz-wall-feeling");if(e(this).parent().hasClass("yz-list-category-items"))e.yz_select_mood_emojis(i,a.attr("data-emoji"),a.attr("data-category-title"),a.find(".yz-item-img").css("background-image"));else{i.find(".yz-list-items-title").text(a.attr("data-category-title")),i.find('input[name="mood_type"]').val(a.attr("data-category")),i.find(".yz-list-categories").fadeOut(),i.find(".yz-feeling-close-icon").addClass("yz-feeling-go-back"),i.find(".yz-feeling-close-icon i").attr("class","far fa-arrow-alt-circle-left"),i.find('input[name="mood_search"]').val("").attr("placeholder",a.find(".yz-item-description").text()),i.find(".yz-list-search-icon i").attr("class",a.find(".yz-item-icon i").attr("class"));var s=i.find('.yz-list-category-items[data-category="'+e(this).attr("data-category")+'"]');1==s.length?s.fadeIn():i.find(".yz-list-submit-button").fadeIn()}}),e(document).on("click",".yz-feeling-close-icon",function(){var t=e(this),a=t.closest(".yz-wall-feeling");if(a.find(".yz-feeling-submit-button").fadeOut(),a.find(".yz-feeling-search-input").val(""),a.find(".yz-feeling-search-input").attr("placeholder",a.find(".yz-feeling-form").attr("data-placeholder")),a.find(".yz-feeling-search-icon i").attr("class","fas fa-search"),t.hasClass("yz-feeling-go-back"))return t.find("i").attr("class","fas fa-times"),a.find(".yz-list-categories, .yz-list-item").fadeIn(),a.find(".yz-list-category-items").fadeOut(),void t.removeClass("yz-feeling-go-back");t.closest(".yz-feeling-form").fadeOut()}),e(document).on("click",".yz-wall-feeling .yz-list-edit-item",function(){var t=e(this),a=t.closest(".yz-wall-feeling"),i=a.find(".yz-list-selected-items");i.fadeOut(200,function(){a.find(".yz-feeling-search-input").val(i.find(".yz-item-title").text()),t.closest(".yz-selected-item").fadeOut(200,function(){e(this).remove()}),a.find(".yz-feeling-form").fadeIn(),a.removeClass("yz-activity-feeling-selected")})}),e(document).on("click",".yz-wall-feeling .yz-list-delete-item",function(){var t=e(this),a=t.closest(".yz-wall-feeling"),i=a.find(".yz-list-selected-items");i.fadeOut(200,function(){i.find(".yz-item-title").text(""),t.closest(".yz-selected-item").fadeOut(200,function(){e(this).remove()}),a.find(".yz-feeling-close-icon").trigger("click"),a.removeClass("yz-activity-feeling-selected")})}),e(document).on("click",".yz-feeling-submit-button",function(){var t=e(this).closest(".yz-wall-feeling"),a=t.find(".yz-feeling-search-input").val();""!=a.trim()&&e.yz_select_mood_emojis(t,a,a)}),e(document).on("keypress",".yz-feeling-search-input",function(t){if(13==t.keyCode){t.preventDefault();var a=e(this).next(".yz-feeling-submit-button");"none"!=a.css("display")&&a.click()}}),e.yz_select_mood_emojis=function(e,t,a,i){e.hasClass("yz-activity-feeling-selected")&&e.find(".yz-selected-item").remove(),e.addClass("yz-activity-feeling-selected"),e.find(".yz-feeling-form").fadeOut(0,function(){e.find(".yz-feeling-selected-items").fadeIn()});var s=null==i?"":"<div class='yz-item-img' style='background-image: "+i+";'></div>",n=null==i?" yz-selected-item-no-image":"";e.find(".yz-list-selected-items").append('<div class="yz-selected-item yz-feeling-selected-item'+n+'">'+s+'<div class="yz-item-title">'+a+'</div><i class="fas fa-pencil-alt yz-selected-item-tool yz-list-edit-item"></i><i class="fas fa-trash-alt yz-selected-item-tool yz-list-delete-item"></i><input type="hidden" name="mood_value" value="'+t+'"></div>').fadeIn(),e.find(".yz-feeling-search-input").val("")},e(document).on("click",".yz-wall-tag-user",function(){var t=e(this);if(!t.hasClass("yz-selected")){t.addClass("yz-selected");var a=t.closest(".yz-list-item");e(this).fadeOut(200,function(){var e="<div class=\"yz-selected-item yz-tagged-user\"><div class='yz-item-img' style='background-image: "+a.find(".yz-item-img").css("background-image")+';\'></div><div class="yz-item-title">'+a.find(".yz-item-title").text()+'</div><i class="fas fa-trash-alt yz-selected-item-tool yz-list-delete-item yz-tagusers-delete-user" data-user-id="'+a.attr("data-user-id")+'"></i><input type="hidden" name="tagged_users[]" value="'+a.attr("data-user-id")+'"></div>';a.closest(".yz-wall-tagusers").find(".yz-tagged-users").append(e);t.closest(".yz-wall-tagusers").find(".yz-tagged-user").length;var i=t.closest(".yz-wall-tagusers");1==i.find(".yz-tagged-user").length&&i.find(".yz-tagged-users").fadeIn()})}}),e(document).on("click",".yz-list-close-icon.yz-tagusers-close-icon",function(){e(this).closest(".yz-tagusers-form").fadeOut()}),e(document).on("click",".yz-tagusers-delete-user",function(){e(this).parent();var t=e(this).closest(".yz-wall-tagusers"),a=e(this).closest(".yz-tagged-users");t.find(".yz-list-item[data-user-id="+e(this).attr("data-user-id")+"] .yz-wall-tag-user").removeClass("yz-selected").fadeIn(),e(this).parent().fadeOut(200,function(){e(this).remove();var t=a.find(".yz-tagged-user").length;0==t&&a.fadeOut()})}),e(document).on("change","#yz-whats-new-post-in",function(t){0!=e(this).val()?e(this).closest(".yz-wall-actions").find("div.yz-activity-privacy").fadeOut():e(this).closest(".yz-wall-actions").find("div.yz-activity-privacy").fadeIn()}),e(document).on("click",".yz-send-comment",function(t){if(t.preventDefault(),!e(this).hasClass("loading")){var a,i,s,n,l,d,o,c,r,f,y,u=e(this);return u.addClass("loading"),y=u.find("i").attr("class"),u.find("i").attr("class","fas fa-spinner fa-spin"),a=u.parents("form"),s=a.parent(),l=a.attr("id").split("-"),s.hasClass("activity-comments")?n=l[2]:(d=s.attr("id").split("-"),n=d[1]),i=e("#"+a.attr("id")+" textarea"),e("#"+a.attr("id")+" div.error").hide(),u.addClass("loading").prop("disabled",!0),i.addClass("loading").prop("disabled",!0),o={action:"new_activity_comment",cookie:bp_get_cookies(),_wpnonce_new_activity_comment:e("#_wpnonce_new_activity_comment").val(),comment_id:n,form_id:l[2],content:i.val()},c=e("#_bp_as_nonce_"+n).val(),c&&(o["_bp_as_nonce_"+n]=c),e.post(ajaxurl,o,function(t){if(u.removeClass("loading"),i.removeClass("loading"),u.find("i").attr("class",y),t[0]+t[1]==="-1")a.append(e(t.substr(2,t.length)).hide().fadeIn(200));else{var s=a.parent();a.fadeOut(200,function(){0===s.children("ul").length&&(s.hasClass("activity-comments")?s.prepend("<ul></ul>"):s.append("<ul></ul>"));var i=e.trim(t);s.children("ul").append(e(i).hide().fadeIn(200)),a.children("textarea").val(""),s.parent().addClass("has-comments")}),e("#"+a.attr("id")+" textarea").val(""),r=Number(e("#activity-"+l[2]+" a.acomment-reply span").html())+1,e("#activity-"+l[2]+" a.acomment-reply span").html(r),f=s.parents(".activity-comments").find(".show-all a"),f&&f.html(BP_DTheme.show_x_comments.replace("%d",r))}e(u).prop("disabled",!1),e(i).prop("disabled",!1)}),!1}}),e(document).on("keypress",".ac-form textarea",function(t){13!=t.which||t.shiftKey||(t.preventDefault(),e(this).closest("form").find(".yz-send-comment").click())}),e.yz_isPostType=function(e,t){return t==e.find('input:radio[name="post_type"]:checked').val()}})})(jQuery);